apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

resources:
  - github.com/jsa4000/homelab-ops//kubernetes/addons/iam/oauth2-proxy?ref=main

patches:
  - target:
      version: v1alpha1
      kind: IngressRoute
      name: oauth2-proxy
    path: ingress-patch.yaml

configMapGenerator:
  - name: oauth2-proxy-zitadel-init-config
    behavior: merge
    literals:
    # - ZITADEL_DOMAIN=zitadel.staging.javiersant.com
    # - REDIRECT_URL=https://oauth.staging.javiersant.com/oauth2/callback
      - ZITADEL_DOMAIN=zitadel.staging.internal.javiersant.com
      - REDIRECT_URL=https://oauth.staging.internal.javiersant.com/oauth2/callback
